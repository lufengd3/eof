{"version":3,"sources":["webpack:///webpack/bootstrap 3dafe5334d778796fa7c","webpack:///./src/index.js","webpack:///./src/Parser.js","webpack:///./src/DataProxy.js","webpack:///./src/utils.js"],"names":[],"mappings":"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","file":"EOF.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 3dafe5334d778796fa7c\n **/","import Parser from 'Parser'\nimport DataProxy from 'DataProxy'\n\nexport default class EOF {\n  /**\n   * @param {String} elmId\n   * @param {Object} data\n   */\n  constructor(elmId, data) {\n    this.version = '0.0.2'\n\n    this._doc = document.currentScript.ownerDocument\n    this._tpl = this._doc.querySelector(`#${elmId}`)\n    this._data = data\n    this.name = elmId\n    this.$              // data proxy \n    this._dataKey\n    \n    this._init();\n  }\n\n  _init() {\n    let self = this\n    let tpl = this._tpl\n    let tplParser = new Parser(tpl, this._data)\n    let result = tplParser.parse()\n    let tplContent = result.tplContent\n    this._data = result.data\n    this._dataKey = result.dataKey\n    \n    if (!tpl) {\n      throw new Error(`Can't find template Node: ${this.name}`)\n    }\n\n    let proto = Object.create(HTMLElement.prototype, {\n      createdCallback: {\n        value() {\n          let clone = document.importNode(tplContent, true)\n\n          // `this` is new Element, diff from `this` of EOF class\n          let shadowRoot = this.createShadowRoot()\n          \n          shadowRoot.appendChild(clone)\n          self._setDataProxy(shadowRoot)\n        }\n      }\n    })\n\n    document.registerElement(this.name, { prototype: proto })\n  }\n\n  _setDataProxy(doc) {\n    let setHandler = (target, key, value) => {\n      console.log(`set ${key} = ${value}`)\n      let idList = this._dataKey[key]\n      let elms = []\n      \n      for (let i = idList.length; i--; ) {\n        let id = idList[i]['id'] \n        let allElms = doc.querySelectorAll(`[data-bind-id=\"${id}\"]`)\n        \n        for (let j = allElms.length; j--; ) {\n          let elmInfo = {\n            elm: allElms[j],\n            type: idList[i]['type'],\n            attr: idList[i]['attr']\n          }\n  \n          elms.push(elmInfo)\n        }\n      }\n      \n      for (let i = elms.length; i--; ) {\n        let elm = elms[i]['elm']\n        let type = elms[i]['type']\n        let attr = elms[i]['attr']\n        \n        if (type === 'attr') {\n          elm.setAttribute(attr, value)  \n        } else {\n          elm.textContent = value\n        }\n        \n      }\n    }\n    \n    let dataProxy = new DataProxy(this._data)\n    \n    dataProxy.handleSet(setHandler)\n    this.$ = dataProxy.setup()\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import { arrUnique } from 'utils'\n\nexport default class parser {\n  constructor(tpl, data) {\n    this._data = data\n    this._tpl = tpl\n    \n  }\n\n  parse() {\n    let tplStr = this._tpl.innerHTML\n    let data = this._data\n    let dataKey = this._getDatakey()\n\n    let attrPattern = /\\w*=\"{{[\\s\\w]*}}\"/g\n    let textPattern = /[^\"]{{[\\s\\w]*}}/g\n    let attrMatch = tplStr.match(attrPattern)\n    let textMatch = tplStr.match(textPattern)\n    attrMatch = arrUnique(attrMatch)\n    textMatch = arrUnique(textMatch)\n    \n    /**\n     * TODO:\n     * multi element has same attr bind\n     * remove same item in array\n     * replace them with same data-bind-key \n     */\n    for (let i = 0; i < attrMatch.length; i++) {\n      let replace = this._replaceVar('attr', tplStr, attrMatch[i])\n      tplStr = replace.htmlStr\n      \n      let dataKeyItem = {\n        id: replace.elmId,\n        type: 'attr',\n        attr: replace.elmAttr\n      }\n      \n      if (dataKey.hasOwnProperty(replace.key)) {\n        dataKey[replace.key].push(dataKeyItem)\n      } else {\n        this._data[replace.key] = null\n        dataKey[replace.key] = [dataKeyItem]\n      }\n    }\n\n    for (let i = 0; i < textMatch.length; i++) {\n      let replace = this._replaceVar('text', tplStr, textMatch[i])\n      tplStr = replace.htmlStr\n      \n      let dataKeyItem = {\n        id: replace.elmId,\n        type: 'text', \n        attr: null\n      }\n      \n      if (dataKey.hasOwnProperty(replace.key)) {\n        dataKey[replace.key].push(dataKeyItem)\n      } else {\n        this._data[replace.key] = null\n        dataKey[replace.key] = [dataKeyItem]\n      }\n    }\n    \n    this._tpl.innerHTML = tplStr;\n    \n    return {\n      tplContent: this._tpl.content,\n      dataKey: dataKey,\n      data: this._data  // padding obj\n    }\n  }\n  \n  /**\n   * @param {String} replaceType: attr or text\n   * @param {String} htmlStr: template innerHTML\n   * @param {String} item: replace pattern {{ variable }}\n   * @return {String} htmlStr\n   */\n  _replaceVar(replaceType, htmlStr, item) {\n    let randKey = String(Math.random()).slice(2)\n    let variable = item.match(/{{\\s*(\\w*)\\s*}}/)[1]\n    let value = this._data[variable] ? this._data[variable] : ''\n    let pattern = new RegExp(item, 'g')\n    let attr = null\n    let replaceMent\n\n    if (replaceType === 'attr') {\n      /**\n       * before: <input value=\"{{ abc }}\">\n       * after: <input value=\"xxx\" data-bind-key=\"xyz\">\n       * replace [[ {{ abc }} ]] with [[ xxx\" data-bind-key=\"xyz ]]\n       * so data-bind-key just has singal quotation marks\n       */\n      let bindFlag = `data-bind-id=\"${randKey}`\n      replaceMent = item.replace(/{{\\s*\\w*\\s*}}/, `${value}\" ${bindFlag}`)\n      attr = item.match(/(\\w*)=.*/)[1]      \n    } else {\n      /**\n       * before: <p>hello {{ name }}</p>\n       * after: <p>hello <span data-bind-key=\"xxx\"> xyz </span></p>\n       */\n      let bindFlagStart = `<span data-bind-id=\"${randKey}\">`;\n      let bindFlagEnd = '</span>';\n      replaceMent = `${bindFlagStart}${value}${bindFlagEnd}`;\n    } \n    \n    htmlStr = htmlStr.replace(pattern, replaceMent)\n    \n    return {\n      htmlStr: htmlStr,\n      key: variable,\n      elmId: randKey,\n      elmAttr: attr\n    }    \n  }\n  \n  _getDatakey() {\n    let obj = {}\n    \n    for (let key in this._data) {\n      obj[key] = []\n    }\n    \n    return obj\n  }\n  \n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Parser.js\n **/","export default class DataProxy {\n  constructor(target) {\n    this._target = target\n    this._handler = {}\n  }\n  \n  setup() {\n    return new Proxy(this._target, this._handler)\n  }\n  \n  handleSet(callback) {\n    this._handler['set'] = callback\n  }\n  \n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/DataProxy.js\n **/","export function arrUnique(arr) {\n  let obj = {}\n  \n  for (let i = arr.length; i--; ) {\n    arr[i] = arr[i].trim()\n    obj[arr[i]] = null\n  }\n  \n  return Object.keys(obj)\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/"],"sourceRoot":""}